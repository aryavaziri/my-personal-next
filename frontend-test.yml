version: '3.7'
  services:
    nginx:
      build:
        context: ./nginx/
      container_name: nginx
      ports:
        - "80:80"
        # - "443:443"
      volumes:
        - ./v1:/var/www/old_website
        - ./nginx:/etc/nginx/conf.d
        - /etc/letsencrypt:/etc/letsencrypt
      depends_on:
        - frontend
    frontend:
      container_name: frontend
      build:
        context: ./frontend
        dockerfile: dev.Dockerfile
      volumes:
        - ./frontend:/app/frontend
        - node_modules:/app/frontend/node_modules/
      environment:
        - NODE_ENV=development
      env_file:
        - .env
      restart: always
      ports:
        - 4000:4000
        - CHOKIDAR_USEPOLLING=true        
volumes:
  node_modules: